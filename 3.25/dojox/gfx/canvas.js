//>>built
require({cache:{"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(k,w,n,u,y,g,d,f,c,a){function z(b,a){if(!r)return b.splice(a,1);var c=b.length;if(c){for(;a<c;)b[a]=b[a+1],a++;b.length--}}var r=!!y("chrome"),m=k.shape={};m.Shape=n("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=
this.matrix=this.shape=this.rawNode=null;if(y("gfxRegistry")){var b=m.register(this);this.getUID=function(){return b}}},destroy:function(){y("gfxRegistry")&&m.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},
getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var b=this.getBoundingBox();if(!b)return null;var c=this._getRealMatrix();return[a.multiplyPoint(c,b.x,b.y),a.multiplyPoint(c,b.x+b.width,b.y),a.multiplyPoint(c,b.x+b.width,b.y+b.height),a.multiplyPoint(c,b.x,b.y+b.height)]},getEventSource:function(){return this.rawNode},setClip:function(b){this.clip=b},getClip:function(){return this.clip},setShape:function(b){this.shape=k.makeParameters(this.shape,b);this.bbox=null;
return this},setFill:function(b){if(!b)return this.fillStyle=null,this;var a=null;if("object"==typeof b&&"type"in b)switch(b.type){case "linear":a=k.makeParameters(k.defaultLinearGradient,b);break;case "radial":a=k.makeParameters(k.defaultRadialGradient,b);break;case "pattern":a=k.makeParameters(k.defaultPattern,b)}else a=k.normalizeColor(b);this.fillStyle=a;return this},setStroke:function(b){if(!b)return this.strokeStyle=null,this;if("string"==typeof b||w.isArray(b)||b instanceof c)b={color:b};b=
this.strokeStyle=k.makeParameters(k.defaultStroke,b);b.color=k.normalizeColor(b.color);return this},setTransform:function(b){this.matrix=a.clone(b?a.normalize(b):a.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var b=this.getParent();b&&(b._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var b=this.getParent();b&&(b._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},
applyRightTransform:function(b){return b?this.setTransform([this.matrix,b]):this},applyLeftTransform:function(b){return b?this.setTransform([b,this.matrix]):this},applyTransform:function(b){return b?this.setTransform([this.matrix,b]):this},removeShape:function(b){this.parent&&this.parent.remove(this,b);return this},_setParent:function(b,a){this.parent=b;return this._updateParentMatrix(a)},_updateParentMatrix:function(b){this.parentMatrix=b?a.clone(b):null;return this._applyTransform()},_getRealMatrix:function(){for(var b=
this.matrix,c=this.parent;c;)c.matrix&&(b=a.multiply(c.matrix,b)),c=c.parent;return b}});m._eventsProcessing={on:function(b,a){return g(this.getEventSource(),b,m.fixCallback(this,k.fixTarget,a))},connect:function(b,a,c){"on"==b.substring(0,2)&&(b=b.substring(2));return this.on(b,c?w.hitch(a,c):a)},disconnect:function(b){return b.remove()}};m.fixCallback=function(b,a,c,d){d||(d=c,c=null);if(w.isString(d)){c=c||u.global;if(!c[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',
c,'")'].join("");return function(f){return a(f,b)?c[d].apply(c,arguments||[]):void 0}}return c?function(f){return a(f,b)?d.apply(c,arguments||[]):void 0}:function(f){return a(f,b)?d.apply(c,arguments):void 0}};w.extend(m.Shape,m._eventsProcessing);m.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(b){var a=b.getParent();a&&a.remove(b,!0);this.children.push(b);return b._setParent(this,this._getRealMatrix())},
remove:function(b,a){for(var c=0;c<this.children.length;++c)if(this.children[c]==b){a||(b.parent=null,b.parentMatrix=null);z(this.children,c);break}return this},clear:function(b){for(var a,c=0;c<this.children.length;++c)a=this.children[c],a.parent=null,a.parentMatrix=null,b&&a.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var b=null;d.forEach(this.children,function(c){var d=c.getBoundingBox();d&&((c=c.getTransform())&&(d=a.multiplyRectangle(c,d)),b?(b.x=Math.min(b.x,
d.x),b.y=Math.min(b.y,d.y),b.endX=Math.max(b.endX,d.x+d.width),b.endY=Math.max(b.endY,d.y+d.height)):b={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});b&&(b.width=b.endX-b.x,b.height=b.endY-b.y);return b}return null},_moveChildToFront:function(b){for(var a=0;a<this.children.length;++a)if(this.children[a]==b){z(this.children,a);this.children.push(b);break}return this},_moveChildToBack:function(b){for(var a=0;a<this.children.length;++a)if(this.children[a]==b){z(this.children,a);this.children.unshift(b);
break}return this}};m.Surface=n("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){d.forEach(this._nodes,f.destroy);this._nodes=[];d.forEach(this._events,function(b){b&&b.remove()});this._events=[];this.rawNode=null;if(y("ie"))for(;this._parent.lastChild;)f.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},
isLoaded:!0,onLoad:function(b){},whenLoaded:function(b,a){var c=w.hitch(b,a);if(this.isLoaded)c(this);else g.once(this,"load",function(b){c(b)})}});w.extend(m.Surface,m._eventsProcessing);m.Rect=n("dojox.gfx.shape.Rect",m.Shape,{constructor:function(b){this.shape=k.getDefault("Rect");this.rawNode=b},getBoundingBox:function(){return this.shape}});m.Ellipse=n("dojox.gfx.shape.Ellipse",m.Shape,{constructor:function(b){this.shape=k.getDefault("Ellipse");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=
this.shape;this.bbox={x:b.cx-b.rx,y:b.cy-b.ry,width:2*b.rx,height:2*b.ry}}return this.bbox}});m.Circle=n("dojox.gfx.shape.Circle",m.Shape,{constructor:function(b){this.shape=k.getDefault("Circle");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=this.shape;this.bbox={x:b.cx-b.r,y:b.cy-b.r,width:2*b.r,height:2*b.r}}return this.bbox}});m.Line=n("dojox.gfx.shape.Line",m.Shape,{constructor:function(b){this.shape=k.getDefault("Line");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=
this.shape;this.bbox={x:Math.min(b.x1,b.x2),y:Math.min(b.y1,b.y2),width:Math.abs(b.x2-b.x1),height:Math.abs(b.y2-b.y1)}}return this.bbox}});m.Polyline=n("dojox.gfx.shape.Polyline",m.Shape,{constructor:function(b){this.shape=k.getDefault("Polyline");this.rawNode=b},setShape:function(b,a){b&&b instanceof Array?(this.inherited(arguments,[{points:b}]),a&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[b]);return this},_normalizePoints:function(){var b=
this.shape.points,a=b&&b.length;if(a&&"number"==typeof b[0]){for(var c=[],d=0;d<a;d+=2)c.push({x:b[d],y:b[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var b=this.shape.points,a=b.length,c=b[0],d=c.x,f=c.y,g=c.x,r=c.y,m=1;m<a;++m)c=b[m],d>c.x&&(d=c.x),g<c.x&&(g=c.x),f>c.y&&(f=c.y),r<c.y&&(r=c.y);this.bbox={x:d,y:f,width:g-d,height:r-f}}return this.bbox}});m.Image=n("dojox.gfx.shape.Image",m.Shape,{constructor:function(b){this.shape=k.getDefault("Image");
this.rawNode=b},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});m.Text=n(m.Shape,{constructor:function(b){this.fontStyle=null;this.shape=k.getDefault("Text");this.rawNode=b},getFont:function(){return this.fontStyle},setFont:function(b){this.fontStyle="string"==typeof b?k.splitFontString(b):k.makeParameters(k.defaultFont,b);this._setFont();return this},getBoundingBox:function(){var b=null;this.getShape().text&&(b=k._base._computeTextBoundingBox(this));
return b}});m.Creator={createShape:function(b){switch(b.type){case k.defaultPath.type:return this.createPath(b);case k.defaultRect.type:return this.createRect(b);case k.defaultCircle.type:return this.createCircle(b);case k.defaultEllipse.type:return this.createEllipse(b);case k.defaultLine.type:return this.createLine(b);case k.defaultPolyline.type:return this.createPolyline(b);case k.defaultImage.type:return this.createImage(b);case k.defaultText.type:return this.createText(b);case k.defaultTextPath.type:return this.createTextPath(b)}return null},
createGroup:function(){return this.createObject(k.Group)},createRect:function(b){return this.createObject(k.Rect,b)},createEllipse:function(b){return this.createObject(k.Ellipse,b)},createCircle:function(b){return this.createObject(k.Circle,b)},createLine:function(b){return this.createObject(k.Line,b)},createPolyline:function(b){return this.createObject(k.Polyline,b)},createImage:function(b){return this.createObject(k.Image,b)},createText:function(b){return this.createObject(k.Text,b)},createPath:function(b){return this.createObject(k.Path,
b)},createTextPath:function(b){return this.createObject(k.TextPath,{}).setText(b)},createObject:function(b,a){return null}};return m})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(k,w,n,u,y){y=n("dojox.gfx.path.Path",y.Shape,{constructor:function(g){this.shape=w.clone(k.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=g;this.segmented=!1},setAbsoluteMode:function(g){this._confirmSegmented();
this.absolute="string"==typeof g?"absolute"==g:g;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var g=this.bbox,d=this._getRealMatrix();this.bbox=null;for(var f=0,c=this.segments.length;f<c;++f)this._updateWithSegment(this.segments[f],
d);d=this.bbox;this.bbox=g;return this.tbbox=d?[{x:d.l,y:d.t},{x:d.r,y:d.t},{x:d.r,y:d.b},{x:d.l,y:d.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(g,d,f){f&&(d=u.multiplyPoint(f,g,d),g=d.x,d=d.y);this.bbox&&"l"in this.bbox?(this.bbox.l>g&&(this.bbox.l=g),this.bbox.r<g&&(this.bbox.r=g),this.bbox.t>d&&(this.bbox.t=d),this.bbox.b<d&&(this.bbox.b=d)):
this.bbox={l:g,b:d,r:g,t:d}},_updateWithSegment:function(g,d){var f=g.args,c=f.length,a;switch(g.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=0;a<c;a+=2)this._updateBBox(f[a],f[a+1],d);this.last.x=f[c-2];this.last.y=f[c-1];this.absolute=!0;break;case "H":for(a=0;a<c;++a)this._updateBBox(f[a],this.last.y,d);this.last.x=f[c-1];this.absolute=!0;break;case "V":for(a=0;a<c;++a)this._updateBBox(this.last.x,f[a],d);this.last.y=f[c-1];this.absolute=!0;break;case "m":a=0;"x"in this.last||
(this._updateBBox(this.last.x=f[0],this.last.y=f[1],d),a=2);for(;a<c;a+=2)this._updateBBox(this.last.x+=f[a],this.last.y+=f[a+1],d);this.absolute=!1;break;case "l":case "t":for(a=0;a<c;a+=2)this._updateBBox(this.last.x+=f[a],this.last.y+=f[a+1],d);this.absolute=!1;break;case "h":for(a=0;a<c;++a)this._updateBBox(this.last.x+=f[a],this.last.y,d);this.absolute=!1;break;case "v":for(a=0;a<c;++a)this._updateBBox(this.last.x,this.last.y+=f[a],d);this.absolute=!1;break;case "c":for(a=0;a<c;a+=6)this._updateBBox(this.last.x+
f[a],this.last.y+f[a+1],d),this._updateBBox(this.last.x+f[a+2],this.last.y+f[a+3],d),this._updateBBox(this.last.x+=f[a+4],this.last.y+=f[a+5],d);this.absolute=!1;break;case "s":case "q":for(a=0;a<c;a+=4)this._updateBBox(this.last.x+f[a],this.last.y+f[a+1],d),this._updateBBox(this.last.x+=f[a+2],this.last.y+=f[a+3],d);this.absolute=!1;break;case "A":for(a=0;a<c;a+=7)this._updateBBox(f[a+5],f[a+6],d);this.last.x=f[c-2];this.last.y=f[c-1];this.absolute=!0;break;case "a":for(a=0;a<c;a+=7)this._updateBBox(this.last.x+=
f[a+5],this.last.y+=f[a+6],d);this.absolute=!1}g=[g.action];for(a=0;a<c;++a)g.push(k.formatNumber(f[a],!0));if("string"==typeof this.shape.path)this.shape.path+=g.join("");else for(a=0,c=g.length;a<c;++a)this.shape.path.push(g[a])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(g,d){this.tbbox=null;var f=this._validSegments[g.toLowerCase()];"number"==typeof f&&(f?d.length>=f&&(g={action:g,args:d.slice(0,d.length-d.length%f)},this.segments.push(g),this._updateWithSegment(g)):
(g={action:g,args:[]},this.segments.push(g),this._updateWithSegment(g)))},_collectArgs:function(g,d){for(var f=0;f<d.length;++f){var c=d[f];"boolean"==typeof c?g.push(c?1:0):"number"==typeof c?g.push(c):c instanceof Array?this._collectArgs(g,c):"x"in c&&"y"in c&&g.push(c.x,c.y)}},moveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"M":"m",g);return this},lineTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);
this._pushSegment(this.absolute?"L":"l",g);return this},hLineTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"H":"h",g);return this},vLineTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"V":"v",g);return this},curveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"C":"c",g);return this},smoothCurveTo:function(){this._confirmSegmented();
var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"S":"s",g);return this},qCurveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"Q":"q",g);return this},qSmoothCurveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"T":"t",g);return this},arcTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"A":
"a",g);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var g=this.shape.path;this.shape.path=[];this._setPath(g);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(g){g=w.isArray(g)?g:g.match(k.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(g){for(var d="",f=[],c=g.length,a=0;a<c;++a){var z=g[a],r=parseFloat(z);isNaN(r)?(d&&this._pushSegment(d,
f),f=[],d=z):f.push(r)}this._pushSegment(d,f)}},setShape:function(g){this.inherited(arguments,["string"==typeof g?{path:g}:g]);this.segmented=!1;this.segments=[];k.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});n=n("dojox.gfx.path.TextPath",y,{constructor:function(g){"text"in this||(this.text=w.clone(k.defaultTextPath));"fontStyle"in this||(this.fontStyle=w.clone(k.defaultFont))},getText:function(){return this.text},setText:function(g){this.text=k.makeParameters(this.text,
"string"==typeof g?{text:g}:g);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(g){this.fontStyle="string"==typeof g?k.splitFontString(g):k.makeParameters(k.defaultFont,g);this._setFont();return this}});return k.path={Path:y,TextPath:n}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(k,w,n){function u(a){var c=Math.cos(a);a=Math.sin(a);var d={x:c+4/3*(1-c),y:a-4/3*c*(1-c)/a};return{s:{x:c,y:-a},c1:{x:d.x,y:-d.y},c2:d,e:{x:c,
y:a}}}var y=2*Math.PI,g=Math.PI/4,d=Math.PI/8,f=g+d,c=u(d);return k.arc={unitArcAsBezier:u,curvePI4:c,arcAsBezier:function(a,k,r,m,b,C,v,t){b=!!b;C=!!C;var z=n._degToRad(m);m=k*k;var w=r*r,x=n.multiplyPoint(n.rotate(-z),{x:(a.x-v)/2,y:(a.y-t)/2}),B=x.x*x.x,J=x.y*x.y;m=Math.sqrt((m*w-m*J-w*B)/(m*J+w*B));isNaN(m)&&(m=0);m={x:m*k*x.y/r,y:-m*r*x.x/k};b==C&&(m={x:-m.x,y:-m.y});m=n.multiplyPoint([n.translate((a.x+v)/2,(a.y+t)/2),n.rotate(z)],m);k=n.normalize([n.translate(m.x,m.y),n.rotate(z),n.scale(k,
r)]);m=n.invert(k);a=n.multiplyPoint(m,a);t=n.multiplyPoint(m,v,t);v=Math.atan2(a.y,a.x);m=v-Math.atan2(t.y,t.x);C&&(m=-m);0>m?m+=y:m>y&&(m-=y);r=d;t=c;r=C?r:-r;a=[];for(b=m;0<b;b-=g)b<f&&(r=b/2,t=u(r),r=C?r:-r,b=0),x=n.normalize([k,n.rotate(v+r)]),C?(m=n.multiplyPoint(x,t.c1),z=n.multiplyPoint(x,t.c2),x=n.multiplyPoint(x,t.e)):(m=n.multiplyPoint(x,t.c2),z=n.multiplyPoint(x,t.c1),x=n.multiplyPoint(x,t.s)),a.push([m.x,m.y,z.x,z.y,x.x,x.y]),v+=2*r;return a}}})},"dojox/gfx/decompose":function(){define(["./_base",
"dojo/_base/lang","./matrix"],function(k,w,n){function u(c,a){return Math.abs(c-a)<=1E-6*(Math.abs(c)+Math.abs(a))}function y(c,a,d,f){if(!isFinite(c))return d;if(!isFinite(d))return c;a=Math.abs(a);f=Math.abs(f);return(a*c+f*d)/(a+f)}function g(c){c=n.normalize(c);var a=-c.xx-c.yy,d=c.xx*c.yy-c.xy*c.yx,f=Math.sqrt(a*a-4*d),a=-(a+(0>a?-f:f))/2,d=d/a,f=c.xy/(a-c.xx),g=1,b=c.xy/(d-c.xx),k=1;u(a,d)&&(f=1,b=g=0,k=1);isFinite(f)||(f=1,g=(a-c.xx)/c.xy,isFinite(g)||(f=(a-c.yy)/c.yx,g=1,isFinite(f)||(f=1,
g=c.yx/(a-c.yy))));isFinite(b)||(b=1,k=(d-c.xx)/c.xy,isFinite(k)||(b=(d-c.yy)/c.yx,k=1,isFinite(b)||(b=1,k=c.yx/(d-c.yy))));c=Math.sqrt(f*f+g*g);var v=Math.sqrt(b*b+k*k);isFinite(f/=c)||(f=0);isFinite(g/=c)||(g=0);isFinite(b/=v)||(b=0);isFinite(k/=v)||(k=0);return{value1:a,value2:d,vector1:{x:f,y:g},vector2:{x:b,y:k}}}function d(c,a){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,f=a.angle1=(Math.atan2(c.yx,c.yy)+Math.atan2(-d*c.xy,d*c.xx))/2,d=Math.cos(f),f=Math.sin(f);a.sx=y(c.xx/d,d,-c.xy/f,f);a.sy=y(c.yy/
d,d,c.yx/f,f);return a}function f(c,a){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,f=a.angle2=(Math.atan2(d*c.yx,d*c.xx)+Math.atan2(-c.xy,c.yy))/2,d=Math.cos(f),f=Math.sin(f);a.sx=y(c.xx/d,d,c.yx/f,f);a.sy=y(c.yy/d,d,-c.xy/f,f);return a}return k.decompose=function(c){var a=n.normalize(c);c={dx:a.dx,dy:a.dy,sx:1,sy:1,angle1:0,angle2:0};if(u(a.xy,0)&&u(a.yx,0))return w.mixin(c,{sx:a.xx,sy:a.yy});if(u(a.xx*a.yx,-a.xy*a.yy))return d(a,c);if(u(a.xx*a.xy,-a.yx*a.yy))return f(a,c);var k,r=new n.Matrix2D(a);k=w.mixin(r,
{dx:0,dy:0,xy:r.yx,yx:r.xy});r=g([a,k]);k=g([k,a]);r=new n.Matrix2D({xx:r.vector1.x,xy:r.vector2.x,yx:r.vector1.y,yy:r.vector2.y});k=new n.Matrix2D({xx:k.vector1.x,xy:k.vector1.y,yx:k.vector2.x,yy:k.vector2.y});a=new n.Matrix2D([n.invert(r),a,n.invert(k)]);d(k,c);a.xx*=c.sx;a.yy*=c.sy;f(r,c);a.xx*=c.sx;a.yy*=c.sy;return w.mixin(c,{sx:a.xx,sy:a.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(k){k=k.bezierutils={};k.tAtLength=function(d,f){var c=0,a=6==d.length,k=0,r=0,m=a?u:
g,b=function(g,v){for(var t=0,q=0;q<g.length-2;q+=2)t+=n(g[q],g[q+1],g[q+2],g[q+3]);q=a?n(d[0],d[1],d[4],d[5]):n(d[0],d[1],d[6],d[7]);t-q>v||k+t>f+v?(++r,g=m(g,.5),b(g[0],v),Math.abs(k-f)<=v||b(g[1],v)):(k+=t,c+=1/(1<<r))};f&&b(d,.5);return c};var w=k.computeLength=function(d){for(var f=6==d.length,c=0,a=0;a<d.length-2;a+=2)c+=n(d[a],d[a+1],d[a+2],d[a+3]);a=f?n(d[0],d[1],d[4],d[5]):n(d[0],d[1],d[6],d[7]);.1<c-a&&(d=f?u(d,.5):y(d,.5),c=w(d[0],f),c+=w(d[1],f));return c},n=k.distance=function(d,f,c,
a){return Math.sqrt((c-d)*(c-d)+(a-f)*(a-f))},u=function(d,f){var c=1-f,a=c*c,g=f*f,k=d[0],m=d[1],b=d[2],n=d[3],v=d[4];d=d[5];var t=a*k+2*c*f*b+g*v,a=a*m+2*c*f*n+g*d;return[[k,m,c*k+f*b,c*m+f*n,t,a],[t,a,c*b+f*v,c*n+f*d,v,d]]},y=function(d,f){var c=1-f,a=c*c,g=a*c,k=f*f,m=k*f,b=d[0],n=d[1],v=d[2],t=d[3],q=d[4],u=d[5],x=d[6];d=d[7];var w=g*b+3*a*f*v+3*c*k*q+m*x,g=g*n+3*a*f*t+3*c*k*u+m*d;return[[b,n,c*b+f*v,c*n+f*t,a*b+2*c*f*v+k*q,a*n+2*c*f*t+k*u,w,g],[w,g,a*v+2*c*f*q+k*x,a*t+2*c*f*u+k*d,c*q+f*x,c*
u+f*d,x,d]]},g=k.splitBezierAtT=function(d,f){return 6==d.length?u(d,f):y(d,f)};return k})},"*noref":1}});
define("dojox/gfx/canvas","./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(k,w,n,u,y,g,d,f,c,a,z,r,m){function b(e,h,l,b,a,c,d,f,g,k){var E,A,m=h.length,n=0;k?(A=k.l/a,n=k.i):A=h[0]/a;for(;c<d;)c+A>d&&(E={l:(c+A-d)*a,i:n},A=d-c),n%2||(e.beginPath(),e.arc(l,b,a,c,c+A,f),g&&e.stroke()),c+=A,++n,A=h[n%m]/a;return E}function C(e,h,l,b){var a=0,c=0,d,f=0;b?(d=b.l,f=b.i):
d=h[0];for(;1>c;)c=m.tAtLength(e,d),1==c&&(a=m.computeLength(e),a={l:d-a,i:f}),e=m.splitBezierAtT(e,c),f%2||l.push(e[0]),e=e[1],++f,d=h[f%h.length];return a}function v(e,h,l,b){var a=[h.last.x,h.last.y].concat(l),c=!(e instanceof Array);l=4===l.length?"quadraticCurveTo":"bezierCurveTo";var d=[];h=C(a,h.canvasDash,d,b);for(b=0;b<d.length;++b)a=d[b],c?(e.moveTo(a[0],a[1]),e[l].apply(e,a.slice(2))):(e.push("moveTo",[a[0],a[1]]),e.push(l,a.slice(2)));return h}function t(e,h,l,b,a,c,d){var f=0,E=0,g=0,
k=m.distance(l,b,a,c),A=0;h=h.canvasDash;var n=l,q=b,r,t=!(e instanceof Array);d?(g=d.l,A=d.i):g+=h[0];for(;.01<Math.abs(1-E);)g>k&&(f={l:g-k,i:A},g=k),E=g/k,d=l+(a-l)*E,r=b+(c-b)*E,A++%2||(t?(e.moveTo(n,q),e.lineTo(d,r)):(e.push("moveTo",[n,q]),e.push("lineTo",[d,r]))),n=d,q=r,g+=h[A%h.length];return f}var q=k.canvas={},G=null,x=z.multiplyPoint,B=Math.PI,J=2*B,D=B/2;r=w.extend;if(y.global.CanvasRenderingContext2D){y=y.doc.createElement("canvas").getContext("2d");var K="function"==typeof y.setLineDash,
N="function"==typeof y.fillText}var M={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};q.Shape=u("dojox.gfx.canvas.Shape",f.Shape,{_render:function(e){e.save();this._renderTransform(e);this._renderClip(e);this._renderShape(e);this._renderFill(e,!0);this._renderStroke(e,!0);e.restore()},_renderClip:function(e){this.canvasClip&&(this.canvasClip.render(e),
e.clip())},_renderTransform:function(e){if("canvasTransform"in this){var h=this.canvasTransform;e.translate(h.dx,h.dy);e.rotate(h.angle2);e.scale(h.sx,h.sy);e.rotate(h.angle1)}},_renderShape:function(e){},_renderFill:function(e,h){if("canvasFill"in this){var l=this.fillStyle;if("canvasFillImage"in this){var b=l.width,a=l.height,c=this.canvasFillImage.width,d=this.canvasFillImage.height,f=Math.min(b==c?1:b/c,a==d?1:a/d),g=(b-f*c)/2,k=(a-f*d)/2;G.width=b;G.height=a;var m=G.getContext("2d");m.clearRect(0,
0,b,a);m.drawImage(this.canvasFillImage,0,0,c,d,g,k,f*c,f*d);this.canvasFill=e.createPattern(G,"repeat");delete this.canvasFillImage}e.fillStyle=this.canvasFill;h&&("pattern"!==l.type||0===l.x&&0===l.y||e.translate(l.x,l.y),e.fill())}else e.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(e,h){var l=this.strokeStyle;l?(e.strokeStyle=l.color.toString(),e.lineWidth=l.width,e.lineCap=l.cap,"number"==typeof l.join?(e.lineJoin="miter",e.miterLimit=l.join):e.lineJoin=l.join,this.canvasDash?K?(e.setLineDash(this.canvasDash),
h&&e.stroke()):this._renderDashedStroke(e,h):h&&e.stroke()):h||(e.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(e,h){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(e){this.inherited(arguments);var h=e?"width"in e?"rect":"cx"in e?"ellipse":"points"in e?"polyline":"d"in e?"path":null:null;if(e&&!h)return this;this.canvasClip=e?O(h,e):null;this.parent&&this.parent._makeDirty();return this}});var O=
function(e,h){switch(e){case "ellipse":return{canvasEllipse:L({shape:h}),render:function(e){return q.Ellipse.prototype._renderShape.call(this,e)}};case "rect":return{shape:w.delegate(h,{r:0}),render:function(e){return q.Rect.prototype._renderShape.call(this,e)}};case "path":return{canvasPath:P(h),render:function(e){this.canvasPath._renderShape(e)}};case "polyline":return{canvasPolyline:h.points,render:function(e){return q.Polyline.prototype._renderShape.call(this,e)}}}return null},P=function(e){var h=
new dojox.gfx.canvas.Path;h.canvasPath=[];h._setPath(e.d);return h},H=function(e,h,l){var b=e.prototype[h];e.prototype[h]=l?function(){this.parent&&this.parent._makeDirty();b.apply(this,arguments);l.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return b.apply(this,arguments)}};H(q.Shape,"setTransform",function(){this.matrix?this.canvasTransform=k.decompose(this.matrix):delete this.canvasTransform});H(q.Shape,"setFill",function(){var e=this.fillStyle,h;if(e){if("object"==
typeof e&&"type"in e){var l=this.surface.rawNode.getContext("2d");switch(e.type){case "linear":case "radial":h="linear"==e.type?l.createLinearGradient(e.x1,e.y1,e.x2,e.y2):l.createRadialGradient(e.cx,e.cy,0,e.cx,e.cy,e.r);n.forEach(e.colors,function(e){h.addColorStop(e.offset,k.normalizeColor(e.color).toString())});break;case "pattern":G||(G=document.createElement("canvas")),l=new Image,this.surface.downloadImage(l,e.src),this.canvasFillImage=l}}else h=e.toString();this.canvasFill=h}else delete this.canvasFill});
H(q.Shape,"setStroke",function(){var e=this.strokeStyle;if(e){var h=this.strokeStyle.style.toLowerCase();h in M&&(h=M[h]);if(h instanceof Array){this.canvasDash=h=h.slice();var l;for(l=0;l<h.length;++l)h[l]*=e.width;if("butt"!=e.cap){for(l=0;l<h.length;l+=2)h[l]-=e.width,1>h[l]&&(h[l]=1);for(l=1;l<h.length;l+=2)h[l]+=e.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!K&&!!this.canvasDash});H(q.Shape,"setShape");q.Group=u("dojox.gfx.canvas.Group",q.Shape,{constructor:function(){f.Container._init.call(this)},
_render:function(e){e.save();this._renderTransform(e);this._renderClip(e);for(var h=0;h<this.children.length;++h)this.children[h]._render(e);e.restore()},destroy:function(){f.Container.clear.call(this,!0);q.Shape.prototype.destroy.apply(this,arguments)}});q.Rect=u("dojox.gfx.canvas.Rect",[q.Shape,f.Rect],{_renderShape:function(e){var h=this.shape,l=Math.min(h.r,h.height/2,h.width/2),b=h.x,a=b+h.width,c=h.y,h=c+h.height,d=b+l,f=a-l,g=c+l,k=h-l;e.beginPath();e.moveTo(d,c);l?(e.arc(f,g,l,-D,0,!1),e.arc(f,
k,l,0,D,!1),e.arc(d,k,l,D,B,!1),e.arc(d,g,l,B,B+D,!1)):(e.lineTo(f,c),e.lineTo(a,k),e.lineTo(d,h),e.lineTo(b,g));e.closePath()},_renderDashedStroke:function(e,h){var l=this.shape,a=Math.min(l.r,l.height/2,l.width/2),c=l.x,d=c+l.width,f=l.y,g=f+l.height,k=c+a,m=d-a,n=f+a,q=g-a;a?(e.beginPath(),l=t(e,this,k,f,m,f),h&&e.stroke(),l=b(e,this.canvasDash,m,n,a,-D,0,!1,h,l),e.beginPath(),l=t(e,this,d,n,d,q,l),h&&e.stroke(),l=b(e,this.canvasDash,m,q,a,0,D,!1,h,l),e.beginPath(),l=t(e,this,m,g,k,g,l),h&&e.stroke(),
l=b(e,this.canvasDash,k,q,a,D,B,!1,h,l),e.beginPath(),l=t(e,this,c,q,c,n,l),h&&e.stroke(),b(e,this.canvasDash,k,n,a,B,B+D,!1,h,l)):(e.beginPath(),l=t(e,this,k,f,m,f),l=t(e,this,m,f,d,q,l),l=t(e,this,d,q,k,g,l),t(e,this,k,g,c,n,l),h&&e.stroke())}});var F=[];(function(){var e=a.curvePI4;F.push(e.s,e.c1,e.c2,e.e);for(var h=45;360>h;h+=45){var l=z.rotateg(h);F.push(x(l,e.c1),x(l,e.c2),x(l,e.e))}})();var L=function(e){var h,l,a,b=[],c=e.shape,d=z.normalize([z.translate(c.cx,c.cy),z.scale(c.rx,c.ry)]);
h=x(d,F[0]);b.push([h.x,h.y]);for(c=1;c<F.length;c+=3)l=x(d,F[c]),a=x(d,F[c+1]),h=x(d,F[c+2]),b.push([l.x,l.y,a.x,a.y,h.x,h.y]);if(e._needsDash){h=[];l=b[0];for(c=1;c<b.length;++c)a=[],C(l.concat(b[c]),e.canvasDash,a),l=[b[c][4],b[c][5]],h.push(a);e._dashedPoints=h}return b};q.Ellipse=u("dojox.gfx.canvas.Ellipse",[q.Shape,f.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=L(this);return this},setStroke:function(){this.inherited(arguments);K||(this.canvasEllipse=L(this));
return this},_renderShape:function(e){var h=this.canvasEllipse,l;e.beginPath();e.moveTo.apply(e,h[0]);for(l=1;l<h.length;++l)e.bezierCurveTo.apply(e,h[l]);e.closePath()},_renderDashedStroke:function(e,h){var l=this._dashedPoints;e.beginPath();for(var b=0;b<l.length;++b)for(var a=l[b],c=0;c<a.length;++c){var d=a[c];e.moveTo(d[0],d[1]);e.bezierCurveTo(d[2],d[3],d[4],d[5],d[6],d[7])}h&&e.stroke()}});q.Circle=u("dojox.gfx.canvas.Circle",[q.Shape,f.Circle],{_renderShape:function(e){var h=this.shape;e.beginPath();
e.arc(h.cx,h.cy,h.r,0,J,1)},_renderDashedStroke:function(e,h){var l=this.shape,b=0,a,c=this.canvasDash.length;for(i=0;b<J;)a=this.canvasDash[i%c]/l.r,i%2||(e.beginPath(),e.arc(l.cx,l.cy,l.r,b,b+a,0),h&&e.stroke()),b+=a,++i}});q.Line=u("dojox.gfx.canvas.Line",[q.Shape,f.Line],{_renderShape:function(e){var h=this.shape;e.beginPath();e.moveTo(h.x1,h.y1);e.lineTo(h.x2,h.y2)},_renderDashedStroke:function(e,h){var l=this.shape;e.beginPath();t(e,this,l.x1,l.y1,l.x2,l.y2);h&&e.stroke()}});q.Polyline=u("dojox.gfx.canvas.Polyline",
[q.Shape,f.Polyline],{setShape:function(){this.inherited(arguments);var e=this.shape.points,h=e[0],l,b;this.bbox=null;this._normalizePoints();if(e.length)if("number"==typeof h)h=e;else for(h=[],b=0;b<e.length;++b)l=e[b],h.push(l.x,l.y);else h=[];this.canvasPolyline=h;return this},_renderShape:function(e){var h=this.canvasPolyline;if(h.length){e.beginPath();e.moveTo(h[0],h[1]);for(var b=2;b<h.length;b+=2)e.lineTo(h[b],h[b+1])}},_renderDashedStroke:function(e,h){var b=this.canvasPolyline,a=0;e.beginPath();
for(var c=0;c<b.length;c+=2)a=t(e,this,b[c],b[c+1],b[c+2],b[c+3],a);h&&e.stroke()}});q.Image=u("dojox.gfx.canvas.Image",[q.Shape,f.Image],{setShape:function(){this.inherited(arguments);var e=new Image;this.surface.downloadImage(e,this.shape.src);this.canvasImage=e;return this},_renderShape:function(e){var b=this.shape;e.drawImage(this.canvasImage,b.x,b.y,b.width,b.height)}});q.Text=u("dojox.gfx.canvas.Text",[q.Shape,f.Text],{_setFont:function(){this.fontStyle?this.canvasFont=k.makeFontString(this.fontStyle):
delete this.canvasFont},getTextWidth:function(){var e=this.shape,b=0,a;e.text&&(a=this.surface.rawNode.getContext("2d"),a.save(),this._renderTransform(a),this._renderFill(a,!1),this._renderStroke(a,!1),this.canvasFont&&(a.font=this.canvasFont),b=a.measureText(e.text).width,a.restore());return b},_render:function(e){e.save();this._renderTransform(e);this._renderFill(e,!1);this._renderStroke(e,!1);this._renderShape(e);e.restore()},_renderShape:function(e){var b=this.shape;b.text&&(e.textAlign="middle"===
b.align?"center":b.align,this.canvasFont&&(e.font=this.canvasFont),this.canvasFill&&e.fillText(b.text,b.x,b.y),this.strokeStyle&&(e.beginPath(),e.strokeText(b.text,b.x,b.y),e.closePath()))}});H(q.Text,"setFont");N||q.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var Q={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",
Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};q.Path=u("dojox.gfx.canvas.Path",[q.Shape,c.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);K||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(b){var e=
w.clone(this.last);this[Q[b.action]](this.canvasPath,b.action,b.args,this._needsDash?this._dashedPath:null);this.last=e;this.inherited(arguments)},_renderShape:function(b){var e=this.canvasPath;b.beginPath();for(var a=0;a<e.length;a+=2)b[e[a]].apply(b,e[a+1])},_renderDashedStroke:K?function(){}:function(b,a){var e=this._dashedPath;b.beginPath();for(var h=0;h<e.length;h+=2)b[e[h]].apply(b,e[h+1]);a&&b.stroke()},_moveToA:function(b,a,c,d){b.push("moveTo",[c[0],c[1]]);d&&d.push("moveTo",[c[0],c[1]]);
for(a=2;a<c.length;a+=2)b.push("lineTo",[c[a],c[a+1]]),d&&(this._dashResidue=t(d,this,c[a-2],c[a-1],c[a],c[a+1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_moveToR:function(b,a,c,d){a="x"in this.last?[this.last.x+=c[0],this.last.y+=c[1]]:[this.last.x=c[0],this.last.y=c[1]];b.push("moveTo",a);d&&d.push("moveTo",a);for(a=2;a<c.length;a+=2)b.push("lineTo",[this.last.x+=c[a],this.last.y+=c[a+1]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-
1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(b,a,c,d){for(a=0;a<c.length;a+=2)d&&(this._dashResidue=t(d,this,this.last.x,this.last.y,c[a],c[a+1],this._dashResidue)),b.push("lineTo",[c[a],c[a+1]]);this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_lineToR:function(b,a,c,d){for(a=0;a<c.length;a+=2)b.push("lineTo",[this.last.x+=c[a],this.last.y+=c[a+1]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,
this._dashResidue));this.lastControl={}},_hLineToA:function(b,a,c,d){for(a=0;a<c.length;++a)b.push("lineTo",[c[a],this.last.y]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],c[a],this.last.y,this._dashResidue));this.last.x=c[c.length-1];this.lastControl={}},_hLineToR:function(b,a,c,d){for(a=0;a<c.length;++a)b.push("lineTo",[this.last.x+=c[a],this.last.y]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl=
{}},_vLineToA:function(b,a,c,d){for(a=0;a<c.length;++a)b.push("lineTo",[this.last.x,c[a]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,c[a],this._dashResidue));this.last.y=c[c.length-1];this.lastControl={}},_vLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,this.last.y+=c[b]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=
0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="C"},_curveToR:function(b,a,c,d){for(a=0;a<c.length;a+=6)b.push("bezierCurveTo",[this.last.x+c[a],this.last.y+c[a+1],this.lastControl.x=this.last.x+c[a+2],this.lastControl.y=this.last.y+c[a+3],this.last.x+c[a+4],this.last.y+c[a+5]]),d&&(this._dashResidue=
v(d,this,b[b.length-1],this._dashResidue)),this.last.x+=c[a+4],this.last.y+=c[a+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1],c[b+2],c[b+3]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=
c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=
c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(b,a,c,d){for(a=0;a<c.length;a+=4)b.push("quadraticCurveTo",c.slice(a,a+4));d&&(this._dashResidue=v(d,this,b[b.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="Q"},_qCurveToR:function(b,a,c,d){for(a=0;a<c.length;a+=4)b.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[a],this.lastControl.y=this.last.y+c[a+1],this.last.x+c[a+
2],this.last.y+c[a+3]]),d&&(this._dashResidue=v(d,this,b[b.length-1],this._dashResidue)),this.last.x+=c[a+2],this.last.y+=c[a+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.type=
"Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(b,a,c,d){for(a=0;a<c.length;a+=2){var e="Q"==this.lastControl.type;b.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[a],this.last.y+c[a+1]]);d&&(this._dashResidue=v(d,this,b[b.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[a];this.last.y+=c[a+1]}},_arcTo:function(b,c,d,f){c=
"a"==c;for(var e=0;e<d.length;e+=7){var h=d[e+5],g=d[e+6];c&&(h+=this.last.x,g+=this.last.y);var k=a.arcAsBezier(this.last,d[e],d[e+1],d[e+2],d[e+3]?1:0,d[e+4]?1:0,h,g);n.forEach(k,function(a){b.push("bezierCurveTo",a)});f&&(this._dashResidue=v(f,this,p,this._dashResidue));this.last.x=h;this.last.y=g}this.lastControl={}},_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=t(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});n.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),
function(a){H(q.Path,a)});q.TextPath=u("dojox.gfx.canvas.TextPath",[q.Shape,c.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});q.Surface=u("dojox.gfx.canvas.Surface",f.Surface,{constructor:function(){f.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){f.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=k.normalizedLength(a);this.height=k.normalizedLength(b);if(!this.rawNode)return this;
a=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,a=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,a=!0);a&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),
delete this.pendingRender))},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(w.hitch(this,this._render),0))},downloadImage:function(a,b){var c=w.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=
b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});q.createSurface=function(a,b,c){if(!b&&!c){var e=g.position(a);b=b||e.w;c=c||e.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");e=new q.Surface;a=d.byId(a);var f=a.ownerDocument.createElement("canvas");f.width=k.normalizedLength(b);f.height=k.normalizedLength(c);a.appendChild(f);
e.rawNode=f;e._parent=a;return e.surface=e};var I=f.Container;u={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return I.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return I.remove.apply(this,arguments)},clear:function(){this._makeDirty();return I.clear.apply(this,arguments)},getBoundingBox:I.getBoundingBox,
_moveChildToFront:function(a){this._makeDirty();return I._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return I._moveChildToBack.apply(this,arguments)}};c={createObject:function(a,b){a=new a;a.surface=this.surface;a.setShape(b);this.add(a);return a}};r(q.Group,u);r(q.Group,f.Creator);r(q.Group,c);r(q.Surface,u);r(q.Surface,f.Creator);r(q.Surface,c);q.fixTarget=function(a,b){return!0};return q});