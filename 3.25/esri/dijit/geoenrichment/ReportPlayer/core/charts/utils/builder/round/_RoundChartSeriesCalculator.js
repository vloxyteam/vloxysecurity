// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.25/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/round/_RoundChartSeriesCalculator","../../ThemeCalculator ../../ChartTypes ../../ChartSorting ../../../../supportClasses/conditionalStyling/ConditionalStyleUtil ../../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../utils/ChartDataUtil ../utils/TooltipInfoBuilder ../utils/ChartDataLabelBuilder dojo/i18n!esri/nls/jsapi".split(" "),function(D,g,w,x,E,y,F,G,k){k=k.geoenrichment.dijit.ReportPlayer.ChartContainer;
return{calcSeries:function(b){var z=b.seriesItems,d=b.chartType,H=b.themeSettings,I=b.viewModel,c=b.visualProperties,J=b.previewFeatureIndex,n=b.sorting;b=[];var p=z[0],q={name:"data",data:[]},m=[],r=0,t=0,u=1E6,v=-1E6,A,e=p.points;d===g.GAUGE&&1===e.length&&(e=e.slice(),e.push({label:k.gaugeOthers}));if(g.isConditionalStylingEnabled(d)&&c.conditionalStyling){var B=x.getStatistics(c.conditionalStyling);B&&p&&(A=y.getChartData(B,e.length))}var C=E.isFieldInfoInPercentState(e[0].fieldInfo),l;e.forEach(function(a,
f){d===g.GAUGE&&1===f?(a=m[0],a=C?Math.max(0,100-a):c.gaugeRangeMax?Math.max(0,c.gaugeRangeMax-(c.gaugeRangeMin||0)-a):0):(a=y.getPreviewValue(a,f,0,!1,d,c,I,J,A),d===g.GAUGE&&0===f&&(l=a,C||(c.gaugeRangeMax&&(a=Math.min(a,c.gaugeRangeMax)),a-=c.gaugeRangeMin||0)));m[f]=a;a=void 0!==l?l:a||0;r+=a;t+=Math.abs(a);u=Math.min(u,a);v=Math.max(v,a)});d===g.GAUGE&&0===m[1]&&(e.length=1);var K=r/e.length;e.forEach(function(a,f){var b=m[f],e=b||0,h;g.isConditionalStylingEnabled(d)&&c.conditionalStyling&&(h=
(h=x.getConditionalStyle(d===g.GAUGE&&0===f?l:e,c.conditionalStyling))&&h.backgroundColor,d===g.GAUGE&&1===f&&c.gaugeConditionalStylingIgnoreOthers&&(h=void 0));h=h||D.calcColorForPoint(a,p,f,0,z.length,d,H);var k=b;d===g.GAUGE&&0===f&&(k=l);q.data.push({originalValue:b,x:1,y:Math.max(1E-4,e),isUnavailableData:isNaN(b),valueProp:"y",unsortedIndex:f,name:a.label,point:a,fill:h,text:G.formatDataLabel(e,a.label,t,c,d),tooltip:F.getTooltipInfo(k,a.label,null,u,v,r,t,K,c,d,h,c.conditionalStyling,a.fieldInfo),
stroke:{width:0}})});g.isSortingEnabled(d)&&n&&n!==w.NONE&&q.data.sort(function(a,b){return(a.y-b.y)*(n===w.DESC?-1:1)});b.push(q);return b}}});