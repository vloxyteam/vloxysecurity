// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.25/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter","dojo/_base/declare dojo/promise/all dojo/when ./portalToEditorUtils/layout/LayoutParser ./portalToEditorUtils/metadata/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),
function(F,G,e,u,v,w,l,x,m,y,z,A){return{provideEditorJson:function(f,a){function B(){function c(b,n,p){return e(a.preProcessFile&&a.preProcessFile(b,n,d),function(c){if(!1!==c)return e(p&&p(),function(){return a.postProcessFile&&a.postProcessFile(b,n,d)})})}if(g&&g.files&&g.files){var f=a.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],r={"theme.css.txt":function(b){return c(b,"theme.css.txt",function(){d.theme=y.fromCssText(b.data,a)})},"metadata.xml":function(b){return c(b,"metadata.xml",
function(){return v.parseMetadataXML(b,d,a)})},"report.xml":function(b){return c(b,"report.xml",function(){return u.parseReportXML({isGraphicReport:q,parsers:l,file:b,templateJson:d,variableProvider:C,tableDefaultStyles:D,processFileName:k,putImageData:function(a,b){a=k(a);m.putImageData(a,b||h[a])},log:E,queryMetaDataFunc:function(b){return a.queryMetaDataFunc&&a.queryMetaDataFunc(b,d)},postProcessTableInSection:function(b,c){a.postProcessTableInSection&&a.postProcessTableInSection(d,b,c)},postProcessImageJson:function(b,
c){a.postProcessImageJson&&a.postProcessImageJson(d,b,c)},postProcessInfographicJson:function(b,c){a.postProcessInfographicJson&&a.postProcessInfographicJson(d,b,c)}})})},generic:function(b,a){return c(b,a)}},t=new z;f.forEach(function(a){var b=g.files.filter(function(b){return b.name===a})[0],c=b&&(r[a]||r.generic);c&&t.add(function(){return e(A.delay(50),function(){return c(b,a)}).otherwise(function(a){d.metadata.parseErrors.push(a);console.log(a)})})});return t.getPromise()}}a=a||{};var q=f.isGraphicReport,
C=a.variableProvider,D=a.tableDefaultStyles||new x,d={documentOptions:{},metadata:{parseErrors:[],mapImageInfosHash:{},comparisonCalculatorsHash:{},locatorCalculatorsHash:{}},theme:null};q?d.sectionsTables=[]:d.sections=[];var g=f.portalJson,h={},k=function(a){return a?a.toLowerCase():""},E=a.log||function(a){};return e(l.initialize(),function(){return e(w.collectImageResources(g,h,k),function(){for(var a in h)m.putImageData(a,h[a]);return e(B(),function(){d.metadata.parseErrors.length||(f.templateJson=
d);delete d.metadata})})})}}});