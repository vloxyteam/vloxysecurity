// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.25/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/DataDrillingExportUtil","dojo/_base/lang dojo/Deferred dojo/when dojo/dom-construct esri/dijit/geoenrichment/ReportPlayer/ReportPlayer esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes esri/dijit/geoenrichment/ReportPlayer/PlayerThemes esri/dijit/geoenrichment/ReportPlayer/DataProviderGE esri/dijit/geoenrichment/ReportPlayer/PlayerCommands ../../reportContainerGrid/utils/PageQueryUtil ../../supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder esri/dijit/geoenrichment/utils/WaitingUtil".split(" "),
function(m,y,n,p,r,t,u,v,d,l,w,x,q){var e={reportPlayerClass:r,dataProviderClass:v,initPlayer:function(){var a=p.create("div",{"class":"esriGEAbsoluteStretched esriGEOffscreen"},document.body),b=new e.dataProviderClass;b.registerCommand(d.PRINT);b.registerCommand(d.IMAGE);b=(new e.reportPlayerClass({theme:u.DARK,dataProvider:b,resizeMode:t.FIT_WINDOW})).placeAt(a);b.__playerDiv=a;return b},destroyPlayer:function(a){a.destroy();p.destroy(a.__playerDiv)}},h={setReportPlayerClass:function(a){e.reportPlayerClass=
a},setDataProviderClass:function(a){e.dataProviderClass=a},canPrintDataDrilling:function(a){return l.getParentReportPlayer(a).config.dataDrilling.canPrint},canExportDataDrilling:function(a){a=l.getParentReportPlayer(a);return a.config.dataDrilling.canExport?(a=a.dataProvider.getCommandById(d.IMAGE))&&a.isBrowserSupported():!1},printDataDrilling:function(a){h._createTemporaryPlayerAndExport(a,!0)},exportDataDrilling:function(a){h._createTemporaryPlayerAndExport(a,!1)},_createTemporaryPlayerAndExport:function(a,
b){var f=l.getParentReportPlayer(a),g=f.getReportData(),d=m.mixin({},g.config);delete d.geoenrichmentUrl;var f={isClassic:g.isClassic,reportType:g.reportType,reportTitle:f.getReportTitle(),templateJson:function(){var c=a._getDataDrillingPanelDimensions(),c=w.createBlankTemplate({elementWidth:c.w,elementHeight:c.h,layout:{numRows:1,numColumns:1}});c.theme=m.clone(a.theme);delete c.theme.document.backgroundImage;var b=a._drillingSections[0].toJson(),b=x.createFieldInfoFromSection(b),d=c.sectionsTables[0].data;
d.data[0].fieldInfos[d.columns[0].field]=b;return c}(),reportObject:g.reportObject,fieldData:f._viewModel.dynamicReportInfo.fieldData,analysisAreas:[f.getCurrentAnalysisArea()],infographicOptions:g.infographicOptions,attachmentsStore:g.attachmentsStore,config:d},k=e.initPlayer();k.onCommandSettingsShown=function(c){q.showProgressPromise(a.dataDrillingViewDiv,c);h.unitTesting_onCommandSettingsShown()};k.onCommandStart=function(c){q.showProgressPromise(a.dataDrillingViewDiv,c)};n(k.setReportData(f,
{waitUntilAllContentIsReady:!0,disableAnimation:!0}),function(){n(k[b?"executePrint":"executeExport"](),function(a){e.destroyPlayer(k);h.unitTesting_onExportCommandFinished(a)})})},unitTesting_onCommandSettingsShown:function(){},unitTesting_onExportCommandFinished:function(a){}};return h});