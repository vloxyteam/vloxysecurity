// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.25/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/excel/LocatorTableInfographicsToExcelUtil","dojo/string dojo/when dojo/promise/all esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicTypes dojo/i18n!esri/nls/jsapi".split(" "),function(m,e,l,p,n,h){h=h.geoenrichment.dijit.ReportPlayer.ReportPlayer;return{exportLocatorTableInfographicsToExcel:function(f){var k=[];return e(f.isContentLoading(),function(){return l(f.getAllReportContainers().map(function(d){return e(d.getContentPromise()||
d.getPagePromise(),function(){var b=[];d.getLayoutCells().forEach(function(a){a.content&&a.content.hasInfographic&&a.content.hasInfographic(n.LOCATOR_TABLE)&&(innerInfographic=a.content.getInfographic().getInnerInfographic(),b.push(innerInfographic.prepareExportToExcelParameters()))});return l(b).then(function(a){k=k.concat(a)})})}))}).then(function(){var d={documentName:m.substitute(h.locatorsExcelFileName,{reportTitle:f.getReportTitle()}),sheets:[],sourceInfos:[],onlyReturnBinary:!0},b={},a={};
k.forEach(function(g){var c=g.sheets[0];c.name=g.shortName;a[c.name]?(a[c.name]++,c.name+=" "+a[c.name]):a[c.name]=1;d.sheets.push(c);g.sourceInfos&&g.sourceInfos.forEach(function(a){b[a.layerID]||(b[a.layerID]=0);b[a.layerID]+=a.numFeatures})});for(var e in b)d.sourceInfos.push({layerID:e,numFeatures:b[e]});return f._viewModel.exportToExcel(d).then(function(a){return[a]})})}}});