// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.25/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/utils/JsonXmlConverter",["dojo/_base/declare","./RegExpUtil"],function(q,m){function r(a,b,c,d){return n(c,d)+"\x3c"+a+(b?p(b):"")+"\x3e"+(d?"\n":"")}function t(a,b,c){return n(b,c)+"\x3c/"+a+"\x3e"+(c?"\n":"")}function u(a,b,c,d){return n(c,d)+"\x3c"+a+(b?p(b):"")+" /\x3e"+(d?"\n":"")}function v(a,b,c){a=m.encodeXML(a,!1);return n(b,c)+a+(c?"\n":"")}function p(a){var b="",c;for(c in a){var d=a[c];Array.isArray(d)&&(d=d.join(";"));void 0!==d&&null!==d&&(b+=" "+c+'\x3d"'+
m.encodeXML(d,!0)+'"')}return b}function n(a,b){if(!b)return"";b="";for(var c=0;c<a;c++)b+="     ";return b}return q(null,{parseJson:function(a,b){function c(a,b){a.text||"#text"==a.name?f+=v(a.text,b,d):a.name&&(a.tags&&a.tags.length?(f+=r(a.name,a.attributes,b,d),a.tags&&a.tags.forEach(function(a){c(a,b+1)}),f+=t(a.name,b,d)):f+=u(a.name,a.attributes,b,d))}var d=b&&b.prettify,f="";b&&b.addDocumentOptions&&(f+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');c(a,0);return f=decodeURIComponent(encodeURIComponent(f).replace("%19",
""))},parseXml:function(a,b){function c(a,h){a.name=h.nodeName;b.saveInnerHTML&&(a.innerHTML=h.innerHTML);if(h.attributes&&h.attributes.length){a.attributes={};for(var g=0;g<h.attributes.length;g++){var k=h.attributes[g],e=k.value;if(!0===e||"true"===e)e=!0;else if(!1===e||"false"===e)e=!1;else if(d&&e){var l=Number(e);isNaN(l)||(e=l)}a.attributes[k.nodeName]=e}}if(h.childNodes&&h.childNodes.length)for(a.tags=[],g=0;g<h.childNodes.length;g++){if(e=k=h.childNodes[g],"#text"!=e.nodeName||(f?e.nodeValue.trim():
e.nodeValue))e={},a.tags.push(e),c(e,k)}else"#text"==h.nodeName&&(a.text=m.decodeXML(h.nodeValue))}b=b||{};var d=b.parseNumbers,f=b.ignoreWhiteSpacedTextNodes,f=void 0===f?!0:f,l={},k;a=(new DOMParser).parseFromString(a,"text/xml").childNodes;for(var g=0;g<a.length;g++)if(1===a[g].nodeType){k=a[g];break}k&&c(l,k);return l},queryJson:function(a,b,c){function d(a,k){a.tags&&a.tags.forEach(function(a){(b.test?b.test(a.name):a.name===b)&&f.push(a);c&&0==k||d(a,k+1)})}var f=[];d(a,0);return f},getInnerHTML:function(a){return a.innerHTML?
a.innerHTML.trim():this.parseJson(a).replace(/^<[^<]*>/,"").replace(/<\/[^<]*>$/,"").trim()},_IS_RICH_RE:/<.+>.*<\/.+>|<br\s*\/>|<\/br>/,_UNRICH_RE:/<.{1,3}>|<\/.{1,3}>|<br\s*\/>|<\/br>/g,isRichText:function(a){return(a=String(a))&&this._IS_RICH_RE.test(a)},unrichHTML:function(a){if(!a)return"";a=m.decodeXML(String(a).trim()).replace(this._UNRICH_RE,"");0===a.indexOf("\x3c")&&-1!==a.indexOf("\x3e")&&(a="");return a}})()});